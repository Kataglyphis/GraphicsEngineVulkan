\doxysection{Shader\+Helper.\+cpp}
\label{_shader_helper_8cpp_source}\index{C:/Users/jonas/Desktop/GraphicsEngineVulkan/Src/vulkan\_base/ShaderHelper.cpp@{C:/Users/jonas/Desktop/GraphicsEngineVulkan/Src/vulkan\_base/ShaderHelper.cpp}}
\mbox{\hyperlink{_shader_helper_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#include "{}ShaderHelper.h"{}}}
\DoxyCodeLine{00002 }
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{00004 }
\DoxyCodeLine{00005 \textcolor{preprocessor}{\#include "{}Utilities.h"{}}}
\DoxyCodeLine{00006 }
\DoxyCodeLine{00007 ShaderHelper::ShaderHelper() \{\}}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{keywordtype}{void} ShaderHelper::compileShader(\textcolor{keyword}{const} std::string\& shader\_src\_dir,}
\DoxyCodeLine{00010                                  \textcolor{keyword}{const} std::string\& shader\_name) \{}
\DoxyCodeLine{00011   \textcolor{comment}{// GLSLC\_EXE is set by cmake to the location of the vulkan glslc}}
\DoxyCodeLine{00012   std::stringstream shader\_src\_path;}
\DoxyCodeLine{00013   std::stringstream shader\_log\_file;}
\DoxyCodeLine{00014   std::stringstream cmdShaderCompile;}
\DoxyCodeLine{00015   std::stringstream adminPriviliges;}
\DoxyCodeLine{00016   adminPriviliges << \textcolor{stringliteral}{"{}runas /user:<admin-\/user> \(\backslash\)"{}"{}};}
\DoxyCodeLine{00017 }
\DoxyCodeLine{00018   shader\_src\_path << shader\_src\_dir << shader\_name;}
\DoxyCodeLine{00019   std::string shader\_spv\_path = getShaderSpvDir(shader\_src\_dir, shader\_name);}
\DoxyCodeLine{00020   shader\_log\_file << shader\_src\_dir << shader\_name << \textcolor{stringliteral}{"{}.log.txt"{}};}
\DoxyCodeLine{00021   std::stringstream log\_stdout\_and\_stderr;}
\DoxyCodeLine{00022   log\_stdout\_and\_stderr << \textcolor{stringliteral}{"{} > "{}} << shader\_log\_file.str() << \textcolor{stringliteral}{"{} 2> "{}}}
\DoxyCodeLine{00023                         << shader\_log\_file.str();}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025   cmdShaderCompile  \textcolor{comment}{//<< adminPriviliges.str()}}
\DoxyCodeLine{00026       << GLSLC\_EXE << target << shader\_src\_path.str() << \textcolor{stringliteral}{"{} -\/o "{}}}
\DoxyCodeLine{00027       << shader\_spv\_path;}
\DoxyCodeLine{00028   \textcolor{comment}{//<< log\_stdout\_and\_stderr.str();}}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030   \textcolor{comment}{// std::cout << cmdShaderCompile.str().c\_str();}}
\DoxyCodeLine{00031 }
\DoxyCodeLine{00032   \textcolor{keywordtype}{int} result = system(cmdShaderCompile.str().c\_str());}
\DoxyCodeLine{00033 \}}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00035 std::string ShaderHelper::getShaderSpvDir(\textcolor{keyword}{const} std::string\& shader\_src\_dir,}
\DoxyCodeLine{00036                                           \textcolor{keyword}{const} std::string\& shader\_name) \{}
\DoxyCodeLine{00037   std::string shader\_spv\_dir = \textcolor{stringliteral}{"{}spv/"{}};}
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039   std::stringstream vertShaderSpv;}
\DoxyCodeLine{00040   vertShaderSpv << shader\_src\_dir << shader\_spv\_dir << shader\_name << \textcolor{stringliteral}{"{}.spv"{}};}
\DoxyCodeLine{00041 }
\DoxyCodeLine{00042   \textcolor{keywordflow}{return} vertShaderSpv.str();}
\DoxyCodeLine{00043 \}}
\DoxyCodeLine{00044 }
\DoxyCodeLine{00045 VkShaderModule ShaderHelper::createShaderModule(VulkanDevice* device,}
\DoxyCodeLine{00046                                                 \textcolor{keyword}{const} std::vector<char>\& code) \{}
\DoxyCodeLine{00047   \textcolor{comment}{// shader module create info}}
\DoxyCodeLine{00048   VkShaderModuleCreateInfo shader\_module\_create\_info\{\};}
\DoxyCodeLine{00049   shader\_module\_create\_info.sType = VK\_STRUCTURE\_TYPE\_SHADER\_MODULE\_CREATE\_INFO;}
\DoxyCodeLine{00050   shader\_module\_create\_info.codeSize = code.size();  \textcolor{comment}{// size of code}}
\DoxyCodeLine{00051   shader\_module\_create\_info.pCode =}
\DoxyCodeLine{00052       \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }uint32\_t*\textcolor{keyword}{>}(code.data());  \textcolor{comment}{// pointer to code}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054   VkShaderModule shader\_module;}
\DoxyCodeLine{00055   VkResult result =}
\DoxyCodeLine{00056       vkCreateShaderModule(device-\/>getLogicalDevice(),}
\DoxyCodeLine{00057                            \&shader\_module\_create\_info, \textcolor{keyword}{nullptr}, \&shader\_module);}
\DoxyCodeLine{00058 }
\DoxyCodeLine{00059   ASSERT\_VULKAN(result, \textcolor{stringliteral}{"{}Failed to create a shader module!"{}})}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061   return shader\_module;}
\DoxyCodeLine{00062 \}}
\DoxyCodeLine{00063 }
\DoxyCodeLine{00064 ShaderHelper::\string~ShaderHelper() \{\}}

\end{DoxyCode}
