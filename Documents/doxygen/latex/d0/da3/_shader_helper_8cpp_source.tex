\hypertarget{_shader_helper_8cpp_source}{}\doxysection{Shader\+Helper.\+cpp}
\label{_shader_helper_8cpp_source}\index{C:/Users/jonas\_l6e3q/Desktop/GraphicsEngineVulkan/Src/vulkan\_base/ShaderHelper.cpp@{C:/Users/jonas\_l6e3q/Desktop/GraphicsEngineVulkan/Src/vulkan\_base/ShaderHelper.cpp}}
\mbox{\hyperlink{_shader_helper_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}ShaderHelper.h"{}}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00002}00002 \textcolor{preprocessor}{\#include "{}VulkanRendererConfig.h"{}}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include "{}Utilities.h"{}}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00008}00008 ShaderHelper::ShaderHelper() \{\}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00010}00010 \textcolor{keywordtype}{void} ShaderHelper::compileShader(\textcolor{keyword}{const} std::string\& shader\_src\_dir,}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00011}00011                                  \textcolor{keyword}{const} std::string\& shader\_name) \{}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00012}00012   \textcolor{comment}{// GLSLC\_EXE is set by cmake to the location of the vulkan glslc}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00013}00013   std::stringstream shader\_src\_path;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00014}00014   std::stringstream shader\_log\_file;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00015}00015   std::stringstream cmdShaderCompile;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00016}00016   std::stringstream adminPriviliges;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00017}00017   adminPriviliges << \textcolor{stringliteral}{"{}runas /user:<admin-\/user> \(\backslash\)"{}"{}};}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00019}00019   shader\_src\_path << shader\_src\_dir << shader\_name;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00020}00020   std::string shader\_spv\_path = getShaderSpvDir(shader\_src\_dir, shader\_name);}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00021}00021   shader\_log\_file << shader\_src\_dir << shader\_name << \textcolor{stringliteral}{"{}.log.txt"{}};}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00022}00022   std::stringstream log\_stdout\_and\_stderr;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00023}00023   log\_stdout\_and\_stderr << \textcolor{stringliteral}{"{} > "{}} << shader\_log\_file.str() << \textcolor{stringliteral}{"{} 2> "{}}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00024}00024                         << shader\_log\_file.str();}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00025}00025 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00026}00026   cmdShaderCompile  \textcolor{comment}{//<< adminPriviliges.str()}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00027}00027       << GLSLC\_EXE << target << shader\_src\_path.str() << \textcolor{stringliteral}{"{} -\/o "{}}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00028}00028       << shader\_spv\_path;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00029}00029   \textcolor{comment}{//<< log\_stdout\_and\_stderr.str();}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00031}00031   \textcolor{comment}{// std::cout << cmdShaderCompile.str().c\_str();}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00033}00033   system(cmdShaderCompile.str().c\_str());}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00034}00034 \}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00036}00036 std::string ShaderHelper::getShaderSpvDir(\textcolor{keyword}{const} std::string\& shader\_src\_dir,}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00037}00037                                           \textcolor{keyword}{const} std::string\& shader\_name) \{}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00038}00038   std::string shader\_spv\_dir = \textcolor{stringliteral}{"{}spv/"{}};}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00040}00040   std::stringstream vertShaderSpv;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00041}00041   vertShaderSpv << shader\_src\_dir << shader\_spv\_dir << shader\_name << \textcolor{stringliteral}{"{}.spv"{}};}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00043}00043   \textcolor{keywordflow}{return} vertShaderSpv.str();}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00044}00044 \}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00046}00046 VkShaderModule ShaderHelper::createShaderModule(VulkanDevice* device,}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00047}00047                                                 \textcolor{keyword}{const} std::vector<char>\& code) \{}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00048}00048   \textcolor{comment}{// shader module create info}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00049}00049   VkShaderModuleCreateInfo shader\_module\_create\_info\{\};}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00050}00050   shader\_module\_create\_info.sType = VK\_STRUCTURE\_TYPE\_SHADER\_MODULE\_CREATE\_INFO;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00051}00051   shader\_module\_create\_info.codeSize = code.size();  \textcolor{comment}{// size of code}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00052}00052   shader\_module\_create\_info.pCode =}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00053}00053       \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }uint32\_t*\textcolor{keyword}{>}(code.data());  \textcolor{comment}{// pointer to code}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00055}00055   VkShaderModule shader\_module;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00056}00056   VkResult result =}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00057}00057       vkCreateShaderModule(device-\/>getLogicalDevice(),}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00058}00058                            \&shader\_module\_create\_info, \textcolor{keyword}{nullptr}, \&shader\_module);}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00060}00060   ASSERT\_VULKAN(result, \textcolor{stringliteral}{"{}Failed to create a shader module!"{}})}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00062}00062   return shader\_module;}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00063}00063 \}}
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{_shader_helper_8cpp_source_l00065}00065 ShaderHelper::\string~ShaderHelper() \{\}}

\end{DoxyCode}
